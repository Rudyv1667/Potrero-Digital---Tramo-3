
{% extends "layout.html" %}  <!-- declaro de donde traigo la plantilla -->

{% block content %}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Cursos</title>
  </head>
  <body>
    <div class="box-container">
      <div class="backbtn">
        <a href="{{ url_for ('configuracion')}}"><button type="button" class="btn btn-info btn-small-left" id="btnatras">Atrás</button></a>
      </div>
      <div class="container">
        <div class="card-deck-pdp" id="card-deck"></div>
      </div>
    </div>
    <script>
      // Función que obtiene los datos de la API y crea las cards
      function obtenerDatos() {
        fetch('https://pd-api-firebase-default-rtdb.firebaseio.com/Cursos.json')
          .then(response => response.json())
          .then(data => {
            const cardDeck = document.getElementById('card-deck');
            for (let key in data) {
              const objeto = data[key];

              const card = document.createElement('div');
              card.classList.add('box-courses');

              const imagen = document.createElement('img');
              imagen.classList.add('card-img-top');
              imagen.src = objeto.Pic;

              const cardBody = document.createElement('div');
              cardBody.classList.add('card-body');

              const titulo = document.createElement('h5');
              titulo.classList.add('card-title');
              titulo.textContent = objeto.Nombre;

              const descripcion = document.createElement('p');
              descripcion.classList.add('card-text');
              descripcion.textContent = objeto.Descripcion;

              const duracion = document.createElement('p');
              duracion.classList.add('card-text');
              duracion.textContent = 'Duración: ' + objeto.Duracion + ' años';

              const materias = document.createElement('p');
              materias.classList.add('card-text');
              materias.textContent = 'Cantidad de materias: ' + objeto.Materias;

              const eliminar = document.createElement('button');
              eliminar.classList.add('btn', 'btn-danger');
              eliminar.textContent = 'Eliminar';
              eliminar.addEventListener('click', () => {
                borrarDatos(key);
                card.remove();
                alert('Curso eliminado correctamente.');
              });

              cardBody.appendChild(titulo);
              cardBody.appendChild(descripcion);
              cardBody.appendChild(duracion);
              cardBody.appendChild(materias);
              cardBody.appendChild(eliminar);

              card.appendChild(imagen);
              card.appendChild(cardBody);

              cardDeck.appendChild(card);
            }
          });
      }

      // Función que borra los datos de la API
      function borrarDatos(key) {
        fetch(`https://pd-api-firebase-default-rtdb.firebaseio.com/Cursos/${key}.json`, {
          method: 'DELETE'
        });
      }

      // Ejecutar la función obtenerDatos al cargar la página
      obtenerDatos();
    </script>
  </body>
</html>

{% endblock%}